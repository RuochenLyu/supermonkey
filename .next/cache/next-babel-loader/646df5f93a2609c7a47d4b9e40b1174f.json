{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/ruochen/Documents/workspace/supermonkey/pages/index.js\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport _fetch from \"isomorphic-unfetch\";\nimport \"../styles/reset.scss\";\nimport \"../styles/global.scss\";\nimport style from \"../styles/layout.scss\";\nimport Head from \"../components/head\";\nimport Nav from \"../components/nav\";\nimport Schedule from \"../components/schedule\";\nimport Loading from \"../components/loading\";\nimport Data from \"../data\";\n\nvar Index =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Index, _React$Component);\n\n  function Index(props) {\n    var _this;\n\n    _classCallCheck(this, Index);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Index).call(this, props));\n    _this.handleBoxIdChange = _this.handleBoxIdChange.bind(_assertThisInitialized(_this));\n    _this.state = {\n      loading: true // data: {},\n      // boxId: null,\n      // currentCity: null,\n\n    };\n    return _this;\n  }\n\n  _createClass(Index, [{\n    key: \"handleBoxIdChange\",\n    value: function handleBoxIdChange(boxId) {\n      this.setState({\n        boxId: boxId\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var boxId = localStorage.getItem(\"boxId\");\n      var currentCity = localStorage.getItem(\"currentCity\") || \"北京市\";\n      var cityMap = Data.data.main.boxArea.cityMap;\n      var boxList = cityMap[currentCity][0].boxList;\n\n      if (boxList.every(function (item) {\n        return item.boxId !== boxId;\n      })) {\n        boxId = boxList[0].boxId;\n      }\n\n      this.setState({\n        loading: false,\n        data: Data.data,\n        boxId: boxId,\n        currentCity: currentCity\n      });\n    }\n  }, {\n    key: \"fetch\",\n    value: function () {\n      var _fetch2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(city) {\n        var result, json;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.setState({\n                  loading: true\n                });\n                _context.next = 3;\n                return _fetch(\"https://busi.supermonkey.com.cn/wxClass/getClassSelectList3?city=\".concat(encodeURI(city)));\n\n              case 3:\n                result = _context.sent;\n                _context.next = 6;\n                return result.json();\n\n              case 6:\n                json = _context.sent;\n                console.log(json.data); // return { data: json.data }\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function fetch(_x) {\n        return _fetch2.apply(this, arguments);\n      }\n\n      return fetch;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var loading = this.state.loading;\n      if (loading) return __jsx(Loading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      });\n      var _this$state = this.state,\n          data = _this$state.data,\n          boxId = _this$state.boxId,\n          currentCity = _this$state.currentCity;\n      return __jsx(\"div\", {\n        className: style.main,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }, __jsx(Head, {\n        title: \"\\u8D85\\u7EA7\\u7329\\u7329\\xB7\\u8BFE\\u7A0B\\u8868\",\n        description: \"\\u8D85\\u7EA7\\u7329\\u7329\\u5065\\u8EAB\\u5728\\u7EBF\\u8BFE\\u7A0B\\u8868\",\n        url: \"https://super.kshift.me\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }), __jsx(Nav, {\n        data: data,\n        boxId: boxId,\n        currentCity: currentCity,\n        onBoxIdChange: this.handleBoxIdChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }), __jsx(Schedule, {\n        data: data,\n        boxId: boxId,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Index;\n}(React.Component);\n\nexport default Index;","map":{"version":3,"sources":["/Users/ruochen/Documents/workspace/supermonkey/pages/index.js"],"names":["React","fetch","style","Head","Nav","Schedule","Loading","Data","Index","props","handleBoxIdChange","bind","state","loading","boxId","setState","localStorage","getItem","currentCity","cityMap","data","main","boxArea","boxList","every","item","city","encodeURI","result","json","console","log","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport fetch from \"isomorphic-unfetch\";\nimport \"../styles/reset.scss\";\nimport \"../styles/global.scss\";\nimport style from \"../styles/layout.scss\";\n\nimport Head from \"../components/head\";\nimport Nav from \"../components/nav\";\nimport Schedule from \"../components/schedule\";\nimport Loading from \"../components/loading\";\nimport Data from \"../data\";\n\nclass Index extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleBoxIdChange = this.handleBoxIdChange.bind(this);\n    this.state = {\n      loading: true,\n      // data: {},\n      // boxId: null,\n      // currentCity: null,\n    };\n  }\n\n  handleBoxIdChange(boxId) {\n    this.setState({ boxId });\n  }\n\n  componentDidMount() {\n    let boxId = localStorage.getItem(\"boxId\");\n    const currentCity = localStorage.getItem(\"currentCity\") || \"北京市\";\n    const { cityMap } = Data.data.main.boxArea;\n    const { boxList } = cityMap[currentCity][0];\n\n    if (boxList.every(item => item.boxId !== boxId)) {\n      boxId = boxList[0].boxId;\n    }\n\n    this.setState({\n      loading: false,\n      data: Data.data,\n      boxId,\n      currentCity,\n    });\n  }\n\n  async fetch(city) {\n    this.setState({ loading: true });\n    const result = await fetch(\n      `https://busi.supermonkey.com.cn/wxClass/getClassSelectList3?city=${encodeURI(\n        city\n      )}`\n    );\n    const json = await result.json();\n    console.log(json.data);\n    // return { data: json.data }\n  }\n\n  render() {\n    const { loading } = this.state;\n    if (loading) return <Loading />;\n\n    const { data, boxId, currentCity } = this.state;\n    return (\n      <div className={style.main}>\n        <Head\n          title=\"超级猩猩·课程表\"\n          description=\"超级猩猩健身在线课程表\"\n          url=\"https://super.kshift.me\"\n        />\n        <Nav\n          data={data}\n          boxId={boxId}\n          currentCity={currentCity}\n          onBoxIdChange={this.handleBoxIdChange}\n        />\n        <Schedule data={data} boxId={boxId} />\n      </div>\n    );\n  }\n}\n\nexport default Index;\n"]},"metadata":{},"sourceType":"module"}