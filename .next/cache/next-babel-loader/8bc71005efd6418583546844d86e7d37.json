{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/ruochen/Documents/workspace/supermonkey/pages/index.js\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport _fetch from \"isomorphic-unfetch\";\nimport \"../styles/reset.scss\";\nimport \"../styles/global.scss\";\nimport style from \"../styles/layout.scss\";\nimport Loading from \"../components/loading\";\nimport Head from \"../components/head\";\nimport CityPicker from \"../components/city-picker\";\nimport BoxList from \"../components/box-list\";\nimport Schedule from \"../components/schedule\";\nimport Data from \"../data\";\n\nvar Index =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Index, _React$Component);\n\n  function Index(props) {\n    var _this;\n\n    _classCallCheck(this, Index);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Index).call(this, props));\n    _this.handleBoxIdChange = _this.handleBoxIdChange.bind(_assertThisInitialized(_this));\n    _this.handleCurrentCityChange = _this.handleCurrentCityChange.bind(_assertThisInitialized(_this));\n    _this.state = {\n      loading: true\n    };\n    return _this;\n  }\n\n  _createClass(Index, [{\n    key: \"handleBoxIdChange\",\n    value: function handleBoxIdChange(boxId) {\n      this.setState({\n        boxId: boxId\n      });\n      localStorage.setItem(\"supermonkey/boxId\", boxId);\n    }\n  }, {\n    key: \"handleCurrentCityChange\",\n    value: function handleCurrentCityChange(currentCity) {\n      this.setState({\n        currentCity: currentCity\n      });\n      localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var boxId = localStorage.getItem(\"supermonkey/boxId\");\n      var currentCity = localStorage.getItem(\"supermonkey/currentCity\") || \"北京市\";\n      var cityMap = Data.data.main.boxArea.cityMap;\n      var boxList = cityMap[currentCity][0].boxList;\n\n      if (boxList.every(function (item) {\n        return item.boxId !== boxId;\n      })) {\n        boxId = boxList[0].boxId;\n      }\n\n      this.setState({\n        loading: false,\n        data: Data.data,\n        boxId: boxId,\n        currentCity: currentCity\n      });\n      localStorage.setItem(\"supermonkey/boxId\", boxId);\n      localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n    }\n  }, {\n    key: \"fetch\",\n    value: function () {\n      var _fetch2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(city) {\n        var result, json;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.setState({\n                  loading: true\n                });\n                _context.next = 3;\n                return _fetch(\"https://busi.supermonkey.com.cn/wxClass/getClassSelectList3?city=\".concat(encodeURI(city)));\n\n              case 3:\n                result = _context.sent;\n                _context.next = 6;\n                return result.json();\n\n              case 6:\n                json = _context.sent;\n                console.log(json.data); // return { data: json.data }\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function fetch(_x) {\n        return _fetch2.apply(this, arguments);\n      }\n\n      return fetch;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var loading = this.state.loading;\n      if (loading) return __jsx(Loading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      });\n      var _this$state = this.state,\n          data = _this$state.data,\n          boxId = _this$state.boxId,\n          currentCity = _this$state.currentCity;\n      var cityList = data.main.boxArea.cityList;\n      return __jsx(\"div\", {\n        className: style.main,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }, __jsx(Head, {\n        title: \"\\u8D85\\u7EA7\\u7329\\u7329\\xB7\\u8BFE\\u7A0B\\u8868\",\n        description: \"\\u8D85\\u7EA7\\u7329\\u7329\\u5065\\u8EAB\\u5728\\u7EBF\\u8BFE\\u7A0B\\u8868\",\n        url: \"https://super.kshift.me\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }), __jsx(\"nav\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, __jsx(CityPicker, {\n        cityList: cityList,\n        currentCity: currentCity,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }), __jsx(BoxList, {\n        data: data,\n        boxId: boxId,\n        currentCity: currentCity,\n        onBoxIdChange: this.handleBoxIdChange,\n        onCurrentCityChange: this.handleCurrentCityChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      })), __jsx(Schedule, {\n        data: data,\n        boxId: boxId,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Index;\n}(React.Component);\n\nexport default Index;","map":{"version":3,"sources":["/Users/ruochen/Documents/workspace/supermonkey/pages/index.js"],"names":["React","fetch","style","Loading","Head","CityPicker","BoxList","Schedule","Data","Index","props","handleBoxIdChange","bind","handleCurrentCityChange","state","loading","boxId","setState","localStorage","setItem","currentCity","getItem","cityMap","data","main","boxArea","boxList","every","item","city","encodeURI","result","json","console","log","cityList","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport fetch from \"isomorphic-unfetch\";\nimport \"../styles/reset.scss\";\nimport \"../styles/global.scss\";\nimport style from \"../styles/layout.scss\";\n\nimport Loading from \"../components/loading\";\nimport Head from \"../components/head\";\nimport CityPicker from \"../components/city-picker\";\nimport BoxList from \"../components/box-list\";\nimport Schedule from \"../components/schedule\";\nimport Data from \"../data\";\n\nclass Index extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleBoxIdChange = this.handleBoxIdChange.bind(this);\n    this.handleCurrentCityChange = this.handleCurrentCityChange.bind(this);\n    this.state = { loading: true };\n  }\n\n  handleBoxIdChange(boxId) {\n    this.setState({ boxId });\n    localStorage.setItem(\"supermonkey/boxId\", boxId);\n  }\n\n  handleCurrentCityChange(currentCity) {\n    this.setState({ currentCity });\n    localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n  }\n\n  componentDidMount() {\n    let boxId = localStorage.getItem(\"supermonkey/boxId\");\n    const currentCity =\n      localStorage.getItem(\"supermonkey/currentCity\") || \"北京市\";\n    const { cityMap } = Data.data.main.boxArea;\n    const { boxList } = cityMap[currentCity][0];\n\n    if (boxList.every(item => item.boxId !== boxId)) {\n      boxId = boxList[0].boxId;\n    }\n\n    this.setState({\n      loading: false,\n      data: Data.data,\n      boxId,\n      currentCity,\n    });\n    localStorage.setItem(\"supermonkey/boxId\", boxId);\n    localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n  }\n\n  async fetch(city) {\n    this.setState({ loading: true });\n    const result = await fetch(\n      `https://busi.supermonkey.com.cn/wxClass/getClassSelectList3?city=${encodeURI(\n        city\n      )}`\n    );\n    const json = await result.json();\n    console.log(json.data);\n    // return { data: json.data }\n  }\n\n  render() {\n    const { loading } = this.state;\n    if (loading) return <Loading />;\n\n    const { data, boxId, currentCity } = this.state;\n    const { cityList } = data.main.boxArea;\n\n    return (\n      <div className={style.main}>\n        <Head\n          title=\"超级猩猩·课程表\"\n          description=\"超级猩猩健身在线课程表\"\n          url=\"https://super.kshift.me\"\n        />\n        <nav>\n          <CityPicker cityList={cityList} currentCity={currentCity} />\n          <BoxList\n            data={data}\n            boxId={boxId}\n            currentCity={currentCity}\n            onBoxIdChange={this.handleBoxIdChange}\n            onCurrentCityChange={this.handleCurrentCityChange}\n          />\n        </nav>\n        <Schedule data={data} boxId={boxId} />\n      </div>\n    );\n  }\n}\n\nexport default Index;\n"]},"metadata":{},"sourceType":"module"}