{"ast":null,"code":"var _jsxFileName = \"/Users/ruochen/Documents/workspace/supermonkey/pages/index.js\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport fetch from \"isomorphic-unfetch\";\nimport \"../styles/reset.scss\";\nimport \"../styles/global.scss\";\nimport style from \"../styles/layout.scss\";\nimport Loading from \"../components/loading\";\nimport Head from \"../components/head\";\nimport CityPicker from \"../components/city-picker\";\nimport BoxList from \"../components/box-list\";\nimport Schedule from \"../components/schedule\";\nimport Data from \"../data\";\n\nclass Index extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleBoxIdChange = this.handleBoxIdChange.bind(this);\n    this.handleCurrentCityChange = this.handleCurrentCityChange.bind(this);\n    this.state = {\n      loading: true\n    };\n  }\n\n  handleBoxIdChange(boxId) {\n    this.setState({\n      boxId\n    });\n    localStorage.setItem(\"supermonkey/boxId\", boxId);\n  }\n\n  handleCurrentCityChange(currentCity) {// this.setState({ currentCity });\n    // localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n  }\n\n  componentDidMount() {\n    this.fetch(\"成都市\"); // let boxId = localStorage.getItem(\"supermonkey/boxId\") * 1;\n    // const currentCity =\n    //   localStorage.getItem(\"supermonkey/currentCity\") || \"北京市\";\n    // const { cityMap } = Data.data.main.boxArea;\n    // const { boxList } = cityMap[currentCity][0];\n    // if (boxList.every(item => item.boxId !== boxId)) {\n    //   boxId = boxList[0].boxId;\n    // }\n    // this.setState({\n    //   loading: false,\n    //   data: Data.data,\n    //   boxId,\n    //   currentCity,\n    // });\n    // localStorage.setItem(\"supermonkey/boxId\", boxId);\n    // localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n  }\n\n  async fetch(city) {\n    this.setState({\n      loading: true\n    });\n    const result = await fetch(`/static/=${encodeURI(city)}.json`);\n    const json = await result.json();\n    console.log(json.data); // return { data: json.data }\n  }\n\n  render() {\n    const {\n      loading\n    } = this.state;\n    if (loading) return __jsx(Loading, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    });\n    const {\n      data,\n      boxId,\n      currentCity\n    } = this.state;\n    const {\n      cityList\n    } = data.main.boxArea;\n    return __jsx(\"div\", {\n      className: style.main,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }, __jsx(Head, {\n      title: \"\\u8D85\\u7EA7\\u7329\\u7329\\xB7\\u8BFE\\u7A0B\\u8868\",\n      description: \"\\u8D85\\u7EA7\\u7329\\u7329\\u5065\\u8EAB\\u5728\\u7EBF\\u8BFE\\u7A0B\\u8868\",\n      url: \"https://super.kshift.me\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }), __jsx(\"nav\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, __jsx(CityPicker, {\n      cityList: cityList,\n      currentCity: currentCity,\n      onCurrentCityChange: this.handleCurrentCityChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }), __jsx(BoxList, {\n      data: data,\n      boxId: boxId,\n      currentCity: currentCity,\n      onBoxIdChange: this.handleBoxIdChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    })), __jsx(Schedule, {\n      data: data,\n      boxId: boxId,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default Index;","map":{"version":3,"sources":["/Users/ruochen/Documents/workspace/supermonkey/pages/index.js"],"names":["React","fetch","style","Loading","Head","CityPicker","BoxList","Schedule","Data","Index","Component","constructor","props","handleBoxIdChange","bind","handleCurrentCityChange","state","loading","boxId","setState","localStorage","setItem","currentCity","componentDidMount","city","result","encodeURI","json","console","log","data","render","cityList","main","boxArea"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport fetch from \"isomorphic-unfetch\";\nimport \"../styles/reset.scss\";\nimport \"../styles/global.scss\";\nimport style from \"../styles/layout.scss\";\n\nimport Loading from \"../components/loading\";\nimport Head from \"../components/head\";\nimport CityPicker from \"../components/city-picker\";\nimport BoxList from \"../components/box-list\";\nimport Schedule from \"../components/schedule\";\nimport Data from \"../data\";\n\nclass Index extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleBoxIdChange = this.handleBoxIdChange.bind(this);\n    this.handleCurrentCityChange = this.handleCurrentCityChange.bind(this);\n    this.state = { loading: true };\n  }\n\n  handleBoxIdChange(boxId) {\n    this.setState({ boxId });\n    localStorage.setItem(\"supermonkey/boxId\", boxId);\n  }\n\n  handleCurrentCityChange(currentCity) {\n    // this.setState({ currentCity });\n    // localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n  }\n\n  componentDidMount() {\n    this.fetch(\"成都市\");\n    // let boxId = localStorage.getItem(\"supermonkey/boxId\") * 1;\n    // const currentCity =\n    //   localStorage.getItem(\"supermonkey/currentCity\") || \"北京市\";\n    // const { cityMap } = Data.data.main.boxArea;\n    // const { boxList } = cityMap[currentCity][0];\n\n    // if (boxList.every(item => item.boxId !== boxId)) {\n    //   boxId = boxList[0].boxId;\n    // }\n\n    // this.setState({\n    //   loading: false,\n    //   data: Data.data,\n    //   boxId,\n    //   currentCity,\n    // });\n    // localStorage.setItem(\"supermonkey/boxId\", boxId);\n    // localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n  }\n\n  async fetch(city) {\n    this.setState({ loading: true });\n    const result = await fetch(`/static/=${encodeURI(city)}.json`);\n    const json = await result.json();\n    console.log(json.data);\n    // return { data: json.data }\n  }\n\n  render() {\n    const { loading } = this.state;\n    if (loading) return <Loading />;\n\n    const { data, boxId, currentCity } = this.state;\n    const { cityList } = data.main.boxArea;\n\n    return (\n      <div className={style.main}>\n        <Head\n          title=\"超级猩猩·课程表\"\n          description=\"超级猩猩健身在线课程表\"\n          url=\"https://super.kshift.me\"\n        />\n        <nav>\n          <CityPicker\n            cityList={cityList}\n            currentCity={currentCity}\n            onCurrentCityChange={this.handleCurrentCityChange}\n          />\n          <BoxList\n            data={data}\n            boxId={boxId}\n            currentCity={currentCity}\n            onBoxIdChange={this.handleBoxIdChange}\n          />\n        </nav>\n        <Schedule data={data} boxId={boxId} />\n      </div>\n    );\n  }\n}\n\nexport default Index;\n"]},"metadata":{},"sourceType":"module"}