{"ast":null,"code":"var _jsxFileName = \"/Users/ruochen/Documents/workspace/supermonkey/pages/index.js\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport fetch from \"isomorphic-unfetch\";\nimport \"../styles/reset.scss\";\nimport \"../styles/global.scss\";\nimport style from \"../styles/layout.scss\";\nimport Loading from \"../components/loading\";\nimport Head from \"../components/head\";\nimport CityPicker from \"../components/city-picker\";\nimport BoxList from \"../components/box-list\";\nimport Schedule from \"../components/schedule\";\nimport Data from \"../data\";\n\nclass Index extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleBoxIdChange = this.handleBoxIdChange.bind(this);\n    this.handleCurrentCityChange = this.handleCurrentCityChange.bind(this);\n    this.state = {\n      loading: true\n    };\n  }\n\n  handleBoxIdChange(boxId) {\n    this.setState({\n      boxId\n    });\n    localStorage.setItem(\"supermonkey/boxId\", boxId);\n  }\n\n  handleCurrentCityChange(currentCity) {// this.setState({ currentCity });\n    // localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n  }\n\n  componentDidMount() {\n    let boxId = localStorage.getItem(\"supermonkey/boxId\") * 1;\n    const currentCity = localStorage.getItem(\"supermonkey/currentCity\") || \"北京市\";\n    const {\n      cityMap\n    } = Data.data.main.boxArea;\n    const {\n      boxList\n    } = cityMap[currentCity][0];\n\n    if (boxList.every(item => item.boxId !== boxId)) {\n      boxId = boxList[0].boxId;\n    }\n\n    this.setState({\n      loading: false,\n      data: Data.data,\n      boxId,\n      currentCity\n    });\n    localStorage.setItem(\"supermonkey/boxId\", boxId);\n    localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n  }\n\n  async fetch(city) {\n    this.setState({\n      loading: true\n    });\n    const result = await fetch(`https://busi.supermonkey.com.cn/wxClass/getClassSelectList3?city=${encodeURI(city)}`);\n    const json = await result.json();\n    console.log(json.data); // return { data: json.data }\n  }\n\n  render() {\n    const {\n      loading\n    } = this.state;\n    if (loading) return __jsx(Loading, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    });\n    const {\n      data,\n      boxId,\n      currentCity\n    } = this.state;\n    const {\n      cityList\n    } = data.main.boxArea;\n    return __jsx(\"div\", {\n      className: style.main,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, __jsx(Head, {\n      title: \"\\u8D85\\u7EA7\\u7329\\u7329\\xB7\\u8BFE\\u7A0B\\u8868\",\n      description: \"\\u8D85\\u7EA7\\u7329\\u7329\\u5065\\u8EAB\\u5728\\u7EBF\\u8BFE\\u7A0B\\u8868\",\n      url: \"https://super.kshift.me\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }), __jsx(\"nav\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, __jsx(CityPicker, {\n      cityList: cityList,\n      currentCity: currentCity,\n      onCurrentCityChange: this.handleCurrentCityChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }), __jsx(BoxList, {\n      data: data,\n      boxId: boxId,\n      currentCity: currentCity,\n      onBoxIdChange: this.handleBoxIdChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    })), __jsx(Schedule, {\n      data: data,\n      boxId: boxId,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default Index;","map":{"version":3,"sources":["/Users/ruochen/Documents/workspace/supermonkey/pages/index.js"],"names":["React","fetch","style","Loading","Head","CityPicker","BoxList","Schedule","Data","Index","Component","constructor","props","handleBoxIdChange","bind","handleCurrentCityChange","state","loading","boxId","setState","localStorage","setItem","currentCity","componentDidMount","getItem","cityMap","data","main","boxArea","boxList","every","item","city","result","encodeURI","json","console","log","render","cityList"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport fetch from \"isomorphic-unfetch\";\nimport \"../styles/reset.scss\";\nimport \"../styles/global.scss\";\nimport style from \"../styles/layout.scss\";\n\nimport Loading from \"../components/loading\";\nimport Head from \"../components/head\";\nimport CityPicker from \"../components/city-picker\";\nimport BoxList from \"../components/box-list\";\nimport Schedule from \"../components/schedule\";\nimport Data from \"../data\";\n\nclass Index extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleBoxIdChange = this.handleBoxIdChange.bind(this);\n    this.handleCurrentCityChange = this.handleCurrentCityChange.bind(this);\n    this.state = { loading: true };\n  }\n\n  handleBoxIdChange(boxId) {\n    this.setState({ boxId });\n    localStorage.setItem(\"supermonkey/boxId\", boxId);\n  }\n\n  handleCurrentCityChange(currentCity) {\n    // this.setState({ currentCity });\n    // localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n  }\n\n  componentDidMount() {\n    let boxId = localStorage.getItem(\"supermonkey/boxId\") * 1;\n    const currentCity =\n      localStorage.getItem(\"supermonkey/currentCity\") || \"北京市\";\n    const { cityMap } = Data.data.main.boxArea;\n    const { boxList } = cityMap[currentCity][0];\n\n    if (boxList.every(item => item.boxId !== boxId)) {\n      boxId = boxList[0].boxId;\n    }\n\n    this.setState({\n      loading: false,\n      data: Data.data,\n      boxId,\n      currentCity,\n    });\n    localStorage.setItem(\"supermonkey/boxId\", boxId);\n    localStorage.setItem(\"supermonkey/currentCity\", currentCity);\n  }\n\n  async fetch(city) {\n    this.setState({ loading: true });\n    const result = await fetch(\n      `https://busi.supermonkey.com.cn/wxClass/getClassSelectList3?city=${encodeURI(\n        city\n      )}`\n    );\n    const json = await result.json();\n    console.log(json.data);\n    // return { data: json.data }\n  }\n\n  render() {\n    const { loading } = this.state;\n    if (loading) return <Loading />;\n\n    const { data, boxId, currentCity } = this.state;\n    const { cityList } = data.main.boxArea;\n\n    return (\n      <div className={style.main}>\n        <Head\n          title=\"超级猩猩·课程表\"\n          description=\"超级猩猩健身在线课程表\"\n          url=\"https://super.kshift.me\"\n        />\n        <nav>\n          <CityPicker\n            cityList={cityList}\n            currentCity={currentCity}\n            onCurrentCityChange={this.handleCurrentCityChange}\n          />\n          <BoxList\n            data={data}\n            boxId={boxId}\n            currentCity={currentCity}\n            onBoxIdChange={this.handleBoxIdChange}\n          />\n        </nav>\n        <Schedule data={data} boxId={boxId} />\n      </div>\n    );\n  }\n}\n\nexport default Index;\n"]},"metadata":{},"sourceType":"module"}